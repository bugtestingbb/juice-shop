name: Semgrep

on:
  push:
    branches:
    - master
    

jobs:
  semgrep:
    name: semgrep/ci
    
    runs-on: ubuntu-latest
    
    container:
      image: returntocorp/semgrep
      
    steps:
    - uses: actions/checkout@v3
    
    - name: full scan
      run: |
        semgrep --text --output report.txt
      env:
        SEMGREP_RULES: p/cwe-top-25 p/owasp-top-ten p/r2c-security-audit p/javascript p/trailofbits # more at semgrep.dev/explore
        
    - name: save report as pipeline artifact
      uses: actions/upload-artifact@v3
      with:
        name: report.txt
        path: report.txt
